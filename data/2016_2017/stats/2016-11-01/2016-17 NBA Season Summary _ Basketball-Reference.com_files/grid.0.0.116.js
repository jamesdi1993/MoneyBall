(function(){var t,e,i,o,n,r,s,l,a,h,c,p,d,g,u,m,y,f,x,C=function(t,e){function i(){this.constructor=t}for(var o in e)v.call(e,o)&&(t[o]=e[o]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},v={}.hasOwnProperty,S=function(t,e){return function(){return t.apply(e,arguments)}};x=function(){"use strict";var t,e,i,o,n,r,s,l,a,h,c,p,d;return e=void 0,i=void 0,n={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:"	"},h=void 0,o=function(t){throw{name:"SyntaxError",message:t,at:e,text:h}},r=function(t){return t&&t!==i&&o("Expected '"+t+"' instead of '"+i+"'"),i=h.charAt(e),e+=1,i},s=function(){var t,e;for(t=void 0,e="","-"===i&&(e="-",r("-"));i>="0"&&"9">=i;)e+=i,r();if("."===i)for(e+=".";r()&&i>="0"&&"9">=i;)e+=i;if("e"===i||"E"===i)for(e+=i,r(),("-"===i||"+"===i)&&(e+=i,r());i>="0"&&"9">=i;)e+=i,r();return t=+e,isFinite(t)?t:void o("Bad number")},a=function(){var t,e,s,l;if(e=void 0,s=void 0,t="",l=void 0,'"'===i)for(;r();){if('"'===i)return r(),t;if("\\"===i)if(r(),"u"===i){for(l=0,s=0;4>s&&(e=parseInt(r(),16),isFinite(e));)l=16*l+e,s+=1;t+=String.fromCharCode(l)}else{if("string"!=typeof n[i])break;t+=n[i]}else t+=i}o("Bad string")},p=function(){for(;i&&" ">=i;)r()},d=function(){switch(i){case"t":return r("t"),r("r"),r("u"),r("e"),!0;case"f":return r("f"),r("a"),r("l"),r("s"),r("e"),!1;case"n":return r("n"),r("u"),r("l"),r("l"),null}o("Unexpected '"+i+"'")},c=void 0,t=function(){var t;if(t=[],"["===i){if(r("["),p(),"]"===i)return r("]"),t;for(;i;){if(t.push(c()),p(),"]"===i)return r("]"),t;r(","),p()}}o("Bad array")},l=function(){var t,e;if(e=void 0,t={},"{"===i){if(r("{"),p(),"}"===i)return r("}"),t;for(;i;){if(e=a(),p(),r(":"),Object.hasOwnProperty.call(t,e)&&o('Duplicate key "'+e+'"'),t[e]=c(),p(),"}"===i)return r("}"),t;r(","),p()}}o("Bad object")},c=function(){switch(p(),i){case"{":return l();case"[":return t();case'"':return a();case"-":return s();default:return i>="0"&&"9">=i?s():d()}},function(t,n){var r;return r=void 0,h=t,e=0,i=" ",r=c(),p(),i&&o("Syntax error"),"function"==typeof n?function(t,e){var i,o,r;if(o=void 0,r=void 0,i=t[e],i&&"object"==typeof i)for(o in i)o=o,Object.prototype.hasOwnProperty.call(i,o)&&(r=walk(i,o),void 0!==r?i[o]=r:delete i[o]);return n.call(t,e,i)}({"":r},""):r}}(),i=function(){var t,e,i,o,n,r,s,l,a;t=["monospace","sans-serif","serif"],a="mmmmmmmmmmlli",l="72px",n=document.getElementsByTagName("body")[0],s=document.createElement("span"),o=function(o){var r,l,a;r=!1;for(l in t)s.style.fontFamily=o+","+t[l],n.appendChild(s),a=s.offsetWidth!==i[t[l]]||s.offsetHeight!==e[t[l]],n.removeChild(s),r=r||a;return r},s.style.fontSize=l,s.innerHTML=a,i={},e={};for(r in t)s.style.fontFamily=t[r],n.appendChild(s),i[t[r]]=s.offsetWidth,e[t[r]]=s.offsetHeight,n.removeChild(s);this.detect=o},c=function(){function t(){this.init()}return t.prototype.init=function(){var t,e,i,o;if(null!=window.options){this.optionIsDefined=!0,this.options={maxLogoHeight:70,maxLogoWidth:200,minCell:1,maxCell:30,logoClk:"#",rfClkPrefix:"",width:300,padding:5,logoPosition:"none",logoHeight:174,logoWidth:800,logoImg:"http://c2.rfihub.net/static/img/24389/RocketFuel-1445211330.png",clkPrefix:"",clkSuffix:"",logoPadding:5,logoColor:"",borderWidth:0,borderColor:"black",borderStyle:"solid",borderPolicy:"always",borderHoverColor:"black",cellTransform:"",cellTransition:"",backgroundImageSize:"contain",overlayStatic:!1,overlayStaticURL:"",showCTA:!1,ctaWidth:60,showContent:"hover",showPromo:!1,promoLoc:"bottom",promoHeight:0,promoWidth:0,minCellWidth:80,maxCellWidth:500,minCellHeight:40,maxCellHeight:500,border:"1px solid #000000",bgColor:"white",animationFrameMillis:1650,animationMaxSecs:30,showDisclaimer:!1,promoText:"",promoBGcolor:"#000",promoBGhoverColor:"#3C3C3C",promoTextColor:"#fff",promoFamily:"Helvetica, Arial, sans-serif",promoTextSize:12,promoLetterSpacing:0,disclaimerCTAcolor:"rgb(115,115,115)",disclaimerCTAsize:11,disclaimerCTAtext:"See Details",disclaimer:"",overlayColor:"rgba(255,255,255,0.95)",overlayToggleDelay:"",textBgColor:"rgba(255,255,255,0.8)",ctaBgColor:"black",ctaBgHoverColor:"black",ctaTextColor:"white",ctaTextFamily:"sans-serif",ctaTextSize:12,ctaRadius:4,ctaText:"BUY NOW",autoScaleFonts:!0,maxFontSize:30,logoAlignment:"middle",bgPattern:"",minDelim:"",majDelim:"",currPos:"",cSym:"",textVertAlign:"middle",useOrigImgs:!1,cellFullOverlay:!1,cellVertAlign:"middle",showCents:!0,overlayAtBeginning:!1,textOnly:!1,overlayAlign:"center",textAreaWidth:"full",cellBgColor:"white",overlayBorderColor:"#000",hoverUnderline:!1,autoScalePercentage:.4,ctaBorderWidth:0,ctaBorderColor:"black",ctaBorderStyle:"solid",showSaleSticker:!1,saleStickerWidth:30,saleStickerContents:[],saleStickerColor:"red",saleStickerContentPrefix:"",saleStickerContentAppendix:"",saleStickerFontSize:0,saleStickerTextColor:"white",saleStickerPosition:"bottomLeft",saleStickerFontFamily:"sans-serif",saleStickerLineHeight:0,saleStickerAutoCalc:!1,saleStickerImg:"",gridStyle:"image-with-text-overlay",splitModeImageLoc:"left",listPriceFontColor:"gray",listPriceFontSize:0,enableBgGradient:!1,bgGradientDirection:90,bgGradientStartColor:"red",bgGradientEndColor:"yellow",gridTop:0,gridLeft:0,gridRight:0,gridBottom:0,innerPadding:0},e=["innerPadding","gridTop","gridLeft","gridRight","gridBottom","minCell","maxCell","width","padding","logoPadding","listPriceFontSize","bgGradientDirection","ctaWidth","borderWidth","minCellWidth","maxCellWidth","minCellHeight","maxCellHeight","animationFrameMillis","animationMaxSecs","promoTextSize","promoLetterSpacing","disclaimerCTAsize","ctaTextSize","ctaRadius","maxFontSize","promoHeight","promoWidth","ctaBorderWidth","saleStickerFontSize","saleStickerLineHeight"],t=["maxLogoHeight","maxLogoWidth","logoHeight","logoWidth","autoScalePercentage"];for(i in options)o=options[i],null==o&&(o=""),e.indexOf(i)>-1?o=parseInt(o):t.indexOf(i)>-1&&(o=parseFloat(o)),""!==o&&(this.options[i]=o);return null==options.ctaBgHoverColor&&(this.options.ctaBgHoverColor=this.options.ctaBgColor),null==options.saleStickerFontFamily&&(this.options.saleStickerFontFamily=this.options.ctaTextFamily),this.options.currFormat={minDelim:this.get("minDelim"),majDelim:this.get("majDelim"),currPos:this.get("currPos"),cSym:this.get("cSym")},this.stripImagesUrlProtocol()}return this.optionIsDefined=!1},t.prototype.get=function(t){return this.options[t]},t.prototype.getInteger=function(t){return parseInt(this.get(t))},t.prototype.getFloat=function(t){return parseFloat(this.get(t))},t.prototype.set=function(t,e){return this.options[t]=e},t.prototype.isDefined=function(){return this.optionIsDefined},t.prototype.hasProperty=function(t){return this.options.hasOwnProperty(t)},t.prototype.attrIsConfigured=function(t){return"undefined"!=typeof window.options[t]&&""!==window.options[t]},t.prototype.attrIsUndefined=function(t){return"undefined"==typeof this.options[t]},t.prototype.attrIsDefined=function(t){return!this.attrIsUndefined(t)},t.prototype.stripProtocol=function(t){return null==t?"":"string"!=typeof t?t:(0===t.indexOf("http")&&(t=t.replace(/^http:/,""),t=t.replace(/^https:/,""),t=window.location.protocol+t),t)},t.prototype.stripImagesUrlProtocol=function(){var t,e,i,o,n,r,s,l;for(this.options.logoImg=this.stripProtocol(this.options.logoImg),this.options.bgPattern=this.stripProtocol(this.options.bgPattern),i=this.options.images,e=0;e<i[0].length;)i[0][e][0]=this.stripProtocol(i[0][e][0]),e++;r=this.options.content.map,s=[];for(n in r)l=r[n],s.push(function(){var e,i,r,s;for(r=l[0],s=[],o=e=0,i=r.length;i>e;o=++e)t=r[o],s.push(this.options.content.map[n][0][o]=this.stripProtocol(t));return s}.call(this));return s},t}(),Array.prototype.indexOf||(Array.prototype.indexOf=function(t){var e,i;for(i=this.length>>>0,e=Number(arguments[1])||0,e=0>e?Math.ceil(e):Math.floor(e),0>e&&(e+=i);i>e;){if(e in this&&this[e]===t)return e;e++}return-1}),f=function(t,e){var i,o;for(o in e)i=e[o],t[o]=i;return t},r=function(t,e){return f(t.prototype,e)},t=function(){function t(){this.option=window.rocketfuel.option,this.helper=window.rocketfuel.helper,this.style=window.rocketfuel.style,this.logger=window.rocketfuel.logger,window.rocketfuel.elements=window.rocketfuel.elements||[],this.elements=window.rocketfuel.elements}return t}(),d=function(t){function e(t,i,o,n){e.__super__.constructor.call(this),this.promoYoffset=0,this.showPromo=this.option.get("showPromo")&&""!==this.option.get("promoText"),this.promoLoc=this.option.get("promoLoc"),this.promoTextSize=this.option.getInteger("promoTextSize"),this.promoLetterSpacing=this.option.get("promoLetterSpacing"),this.promoFontFamily=this.option.get("promoFamily"),this.promoHeight=Math.max(this.option.getInteger("promoHeight"),this.getPromoTextHeight(this.option.get("promoText"),i,this.promoTextSize,this.promoLetterSpacing,this.promoFontFamily)),this.promoWidth=this.option.get("promoWidth")}return C(e,t),e.prototype.createPromo=function(t,e,i,o,n){var r;return r=i+encodeURIComponent(t),"top"===this.promoLoc?[this._createPromo(r,e),o,n]:"bottom"===this.promoLoc?(o-=this.promoHeight,[this._createPromo(r,e),o,n]):"left"===this.promoLoc?[this._createPromo(r,e),o,n]:"right"===this.promoLoc?[this._createPromo(r,e),o,n]:void 0},e.prototype._createPromo=function(t,e){var i,o,n,r,s,l,a;return l=this.option.get("promoText"),r=this.option.get("promoBGcolor"),n=document.createElement("div"),this.helper.addClass(n,""+this._promoClassName()),"top"===this.promoLoc||"bottom"===this.promoLoc?(i=e[2]+1,this.setPromoStyle("div."+this._promoClassName(),i,r,"vertical")):("left"===this.promoLoc||"right"===this.promoLoc)&&(o=e[1]+1,this.setPromoStyle("div."+this._promoClassName(),o,r,"horizontal")),""!==l&&(a=document.createElement("span"),this.helper.addClass(a,""+this._prmoTextClassName()),a.innerHTML=l,this.setPromoTextStyle("span."+this._prmoTextClassName()),n.appendChild(a)),this.helper.addEvent(n,"mouseenter",function(t){return function(){return n.style.backgroundColor=t.option.get("promoBGhoverColor")}}(this)),this.helper.addEvent(n,"mouseleave",function(){return n.style.backgroundColor=r}),s=document.createElement("a"),s.href=t,this.helper.hijackLinkElement(s,t),s.target="_blank",s.appendChild(n),s},e.prototype._promoClassName=function(){return"rf-dc-promo"},e.prototype._prmoTextClassName=function(){return"rf-dc-prmo-text"},e.prototype.setPromoTextStyle=function(t){return this.style.content+=t+"{ color: "+this.option.get("promoTextColor")+"; font-family: "+this.helper.addFallBackFont(this.option.get("promoFamily"))+"; font-size: "+this.promoTextSize+"px; letter-spacing: "+this.option.get("promoLetterSpacing")+"px; display: table-cell; vertical-align: middle; text-align: center; }"},e.prototype.getPromoTextHeight=function(t,e,i,o,n){var r,s,l;return null==i&&(i=14),null==o&&(o=1),r=document.createElement("div"),r.style.position="absolute",r.style.width=e-6+"px",l=document.createElement("span"),l.style.position="absolute",l.innerHTML=t,l.style.fontSize=i+"px",l.style.letterSpacing=o+"px",l.style.fontFamily=n,l.display="table",r.appendChild(l),document.body.appendChild(r),s=l.clientHeight,document.body.removeChild(r),s+4},e.prototype.setPromoStyle=function(t,e,i,o){if(null==o&&(o="vertical"),"vertical"===o){if(this.style.content+=t+"{ display: table; z-index: 101; position: absolute; padding: 0px; width: 100%; text-align: center; height: "+this.promoHeight+"px; background-color: "+i+";","bottom"===this.promoLoc)return this.style.content+="top: auto; bottom: 0px;}";if("top"===this.promoLoc)return this.style.content+="top: "+e+"px;}"}else if("horizontal"===o){if(this.style.content+=t+"{ display: table; z-index: 101; position: absolute; padding: 0px; height: calc(100% + 2px); top: 0px; text-align: center; width: "+this.promoWidth+"px; background-color: "+i+";","left"===this.promoLoc)return this.style.content+="left: "+e+"px;}";if("right"===this.promoLoc)return this.style.content+="left: auto; right: 0px;}"}},e}(t),l=function(){function t(t){this.option=t,this.initPriceFormat()}return t.prototype.initPriceFormat=function(){return this.LOCALE_MAP={de_DE:"EUR_de",en_GB:"GBP",en_US:"USD",it_IT:"EUR_front",pt_BR:"BRL",sv_SE:"DKK",fr_FR:"EUR_back",nl_NL:"EUR_front",zh_CN:"CNY",ch_FR:"CHF",es_MX:"MXN"},this.PRICE_FORMAT={EUR_front:{cSym:"&euro;",currPos:0,majDelim:".",minDelim:","},EUR_de:{cSym:"&euro;",currPos:-1,majDelim:",",minDelim:"."},EUR_back:{cSym:"&euro;",currPos:-1,majDelim:".",minDelim:","},USD:{cSym:"$",currPos:0,majDelim:".",minDelim:","},BRL:{cSym:"R$",currPos:0,majDelim:",",minDelim:"."},CHF:{cSym:"&#8355;",currPos:0,majDelim:".",minDelim:"'"},RUB:{cSym:"&#x20bd;",currPos:0,majDelim:",",minDelim:"."},PLN:{cSym:"&#x7a;&#x142;",currPos:0,majDelim:",",minDelim:" "},JPY:{cSym:"&yen;",currPos:0,majDelim:".",minDelim:","},ARS:{cSym:"&#8369;",currPos:0,majDelim:",",minDelim:"."},EGP:{cSym:"E&pound;",currPos:0,majDelim:".",minDelim:","},TRY:{cSym:"&#8378;",currPos:0,majDelim:".",minDelim:","},AED:{cSym:"&#x62f;&#x2e;&#x625;",currPos:0,majDelim:".",minDelim:","},CAD:{cSym:"&#24;",currPos:0,majDelim:".",minDelim:","},GBP:{cSym:"&pound;",currPos:0,majDelim:".",minDelim:","},TND:{cSym:"&#x44;&#x54;",currPos:0,majDelim:".",minDelim:","},HUF:{cSym:"&#x46;&#x74;",currPos:0,majDelim:" ",minDelim:"."},KRW:{cSym:"&#x20a9;",currPos:0,majDelim:" ",minDelim:","},DKK:{cSym:"&#x6b;&#x72;",currPos:-1,majDelim:",",minDelim:"."},CNY:{cSym:"&yen;",currPos:0,majDelim:".",minDelim:","},MXN:{cSym:"&#x24;",currPos:0,majDelim:".",minDelim:","}}},t.prototype.getPriceText=function(t,e,i){var o,n,r;return o=this.PRICE_FORMAT[e]||this.PRICE_FORMAT[this.LOCALE_MAP[e]]||this.PRICE_FORMAT.USD,r=this.formatPrice(parseFloat(t),2,3,o.minDelim,o.majDelim),n=null!==t&&t>0?0===o.currPos?o.cSym+r:r+o.cSym:""},t.prototype.getNumTextElements=function(t){var e,i,o,n;for(n=0,i=0,o=t.length;o>i;i++)e=t[i],null!=e[1]&&-1===e[1].toString().search("price")&&n++;return n},t.prototype.formatPrice=function(t,e,i,o,n){var r,s,l;return s="\\d(?=(\\d{"+(i||3)+"})+"+(null!=(l=e>0)?l:{"\\D":"$"})+")",r=t.toFixed(Math.max(0,~~e)),(n?r.replace(".",n):r).replace(new RegExp(s,"g"),"$&"+(o||",")),window.rocketfuel.option.get("showCents")?(r=t.toFixed(Math.max(0,~~e)),s="\\d(?=(\\d{"+(i||3)+"})+"+(e>0?"\\D":"$")+")"):(r=parseInt(t).toString(),s="\\d(?=(\\d{"+(i||3)+"})+(\\D|$))"),(n?r.replace(".",n):r).replace(new RegExp(s,"g"),"$&"+(o||","))},t.prototype.getCharLimit=function(t,e){var i;return i=0,null!=t[e][1]&&(i=parseInt(t[e][1][1])),i},t.prototype.updateMaxChar=function(t,e,i){return t[e][1][1]=i,t},t.prototype.trimText=function(t,e){var i,o,n,r,s;if("number"!=typeof e&&(e=parseInt(e)),s=t,!e)return s;if(t.length>e){for(o=[],n=t.split(" "),r=0,i=0;r+n[i].length+4<e;)r+=n[i].length+1,o.push(n[i]),i++;s="undefined"==typeof o[0]?t.split(" ")[0].toString().substring(0,e)+"...":o.join(" ")+"..."}return"..."===s&&(s=""),s},t.prototype.hasClass=function(t,e){return t.classList?t.classList.contains(e):!!t.className.match(new RegExp("(\\s|^)"+e+"(\\s|$)"))},t.prototype.addClass=function(t,e){null!=t&&(t.classList?t.classList.add(e):this.hasClass(t,e)||(t.className+=" "+e))},t.prototype.removeClass=function(t,e){var i;null!=t&&(t.classList?t.classList.remove(e):this.hasClass(t,e)&&(i=new RegExp("(\\s|^)"+e+"(\\s|$)"),t.className=t.className.replace(i," ")))},t.prototype.addEvent=function(t,e,i){return t.addEventListener?t.addEventListener(e,i,!1):t.attachEvent?t.attachEvent("on"+e,i):t[e]=i},t.prototype.getElementContentLength=function(t,e,i,o){var n,r;return e[o].length<2?0:(n=t.map[e[o][1][0]][0][i].length,r=parseInt(e[o][1][1]),Math.min(n,r))},t.prototype.getMaxContentTextEleIndex=function(t,e,i,o){var n,r,s,l;for(n=0,r=this.getElementContentLength(t,e,i,0),l=1;o>l;)s=this.getElementContentLength(t,e,i,l),s>r&&(r=s,n=l),l++;return n},t.prototype.checkNavigatorVersion=function(){var t,e;return t=window.navigator.userAgent,e=function(){switch(!1){case!(t.indexOf("MSIE 8")>0):return"IE8";case!(t.indexOf("MSIE 9")>0):return"IE9";case!(t.indexOf("MSIE 1")>0):return"IE10+";case!(t.indexOf("Chrome")>0):return"Chrome";case!(t.indexOf("Safari")>0):return"Safari"}}()},t.prototype.convertRGBA2Hex=function(t){var e,i,o,n,r;return o=t.match(/rgba\((.*?)\,(.*?)\,(.*?)\,(.*?)\)/),r=parseInt(o[1]),i=parseInt(o[2]),e=parseInt(o[3]),n=parseFloat(o[4]),"#"+this.convertFloatToHex(n)+this.convertIntegerToHex(r)+this.convertIntegerToHex(i)+this.convertIntegerToHex(e)},t.prototype.convert2RGBColor=function(t){var e,i,o,n;return null==t?"":(o=t.match(/rgba\((.*?)\,(.*?)\,(.*?)\,(.*?)\)/),null!=o?(n=parseInt(o[1]),i=parseInt(o[2]),e=parseInt(o[3]),"rgb("+n+", "+i+", "+e+")"):t)},t.prototype.convertIntegerToHex=function(t){var e;return e=parseInt(t).toString(16).toUpperCase(),1===e.length?"0"+e:e},t.prototype.convertFloatToHex=function(t){var e;return e=parseInt(255*t).toString(16).toUpperCase(),1===e.length?"0"+e:e},t.prototype.convertRGBA2MSStyle=function(t){var e;return e=this.convertRGBA2Hex(t),"progid:DXImageTransform.Microsoft.gradient(startColorstr="+e+",endColorstr="+e+")"},t.prototype.getStyle=function(t,e){return null!=t?null!=window.getComputedStyle?getComputedStyle(t).getPropertyValue(e):t.currentStyle[e]||"":void 0},t.prototype.getFontSizeStyle=function(t){return null!=window.getComputedStyle?getComputedStyle(t).getPropertyValue("font-size"):t.currentStyle.fontSize},t.prototype.getNonPriceHTML=function(t,e,i){var o,n,r,s,l;for(s="",r=0;r<e.length;)"undefined"!=typeof e[r][1]&&"price"!==e[r][1][0]&&"listprice"!==e[r][1][0].toString().toLowerCase()&&(this.isImage(t.map[e[r][1][0]][0][i])?s+=e[r][0]+t.map[e[r][1][0]][0][i]:(o="undefined"!=typeof e[r][1][1]?parseInt(e[r][1][1]):0,n=t.map[e[r][1][0]][0][i],e[r].length>2&&(n+=e[r][2]),l=this.trimText(n,o),o>3&&""!==l&&(s+=e[r][0]+l))),r++;return s},t.prototype.getIndexesOf=function(t,e){var i,o,n,r;for(r=[],i=0;i<e.length;)o=e.indexOf(t,i),n=r[r.length-1],o>=0&&o!==n&&r.push(o),i++;return r},t.prototype.getPriceHTML=function(t,e,i,o,n,r,s,l){var a,h,c,p;return a="",p="["+n+"]",c=t.indexOf(p),h=t.indexOf(p)+p.length,a=-1!==l?t.substring(r[r.length-2],r[r.length-1])+this.getPriceText(e,i,o)+t.substring(h,s[s.length-1]):t.substring(r[r.length-1],c)+this.getPriceText(e,i,o)+t.substring(h,s[s.length-1])},t.prototype.getBothPricesHTML=function(t,e,i,o,n,r,s){var l;return l=t.substring(r[r.length-2],t.indexOf("["+n[1]+"]"))+this.getPriceText(e[1],i,o)+t.substring(t.indexOf("["+n[1]+"]")+n[1].toString().length+2,s[s.length-2])+t.substring(s[s.length-2],t.indexOf("["+n[0]+"]"))+this.getPriceText(e[0],i,o)+t.substring(t.indexOf("["+n[0]+"]")+n[0].toString().length+2,s[s.length-1])},t.prototype.parseDisplayStructure=function(t){var e,i;if(null!=this.displayEles)return this.displayEles;for(this.displayEles=t.display.split("]"),e=0;e<this.displayEles.length;)this.displayEles[e]=this.displayEles[e].split("["),this.displayEles[e].length>1&&(this.displayEles[e][1]=this.displayEles[e][1].split(",")),e+1<this.displayEles.length&&(i=this.displayEles[e+1].match(/^(.*?)<\/?\w+/),null!=i&&""!==this.trim(i[1])&&(this.displayEles[e].push(i[1]),this.displayEles[e+1]=this.displayEles[e+1].substring(i[1].length))),e++;return this.displayEles},t.prototype.clearCachedDisplayStructure=function(){return this.displayEles=void 0},t.prototype.getPriceLocale=function(t,e){var i,o;return i="currencies",null!=t.map[i]&&(o=t.map[i][0][e]),o},t.prototype.getPriceListprice=function(t,e){var i,o,n,r,s;for(s=[0,0],i=this.parseDisplayStructure(t),n=0;n<i.length;)"undefined"!=typeof i[n][1]&&(o=i[n][1][0],r=parseFloat(t.map[o][0][e]),"price"===o?s[0]=r>0?r:0:"listprice"===o.toString().toLowerCase()&&(s[1]=r>0?r:0)),n++;return 0===s[0]&&s[1]>0&&(s[0]=s[1]),s[0]===s[1]&&(s[1]=0),s},t.prototype.closeHTMLtag=function(t){var e;return e=document.createElement("span"),e.innerHTML=t,e.innerHTML},t.prototype.isImage=function(t){return t.toString().search(".png")>=0||t.toString().search(".jpg")>=0||t.toString().search(".jpeg")>=0||t.toString().search(".gif")>=0},t.prototype.clearNonPriceText=function(t){var e,i,o,n,r,s,l;for(i=this.parseDisplayStructure(t),l=[],n=0,r=i.length;r>n;n++)e=i[n],"undefined"!=typeof e[1]&&"price"!==e[1][0]&&"listprice"!==e[1][0].toString().toLowerCase()?(s=document.querySelectorAll("."+e[1][0]),o=0,l.push(function(){var t;for(t=[];o<s.length;)s[o].style.display="none",t.push(o++);return t}())):l.push(void 0);return l},t.prototype.calculateBGImage=function(t,e){return t.slice(0,-1).join("/")+"/x1/"+e.x1+"/y1/"+e.y1+"/x2/"+e.x2+"/y2/"+e.y2+"/"+t.slice(-1)[0]},t.prototype.hasReachedXPercentage=function(t,e,i,o){return null!=t&&null!=e&&(e.offsetHeight+i)/t.offsetHeight>=o?!0:!1},t.prototype.isMultipleLine=function(t){var e,i;return null==t?!1:(i=t.clientHeight,e=parseInt(this.getFontSizeStyle(t)),i/e>2)},t.prototype.getImageDims=function(t,e,i){var o,n,r;return n=i&&"x1"in i&&"x2"in i?i.x2-i.x1:t,o=i&&"y1"in i&&"y2"in i?i.y2-i.y1:e,r=Math.max(n/t,o/e),[Math.floor(n/r),Math.floor(o/r)]},t.prototype.findFirstCharDistance=function(t,e,i){var o;for(null==i&&(i=0),o=i;e[o]!==t&&o<e.length;)o++;return o},t.prototype.hijackLinkElement=function(t,e){var i;return i=function(t){window.open(encodeURI(e)),"undefined"!=typeof t&&"undefined"!=typeof t.stopPropagation&&t.stopPropagation(),"undefined"!=typeof t&&"undefined"!=typeof t.preventDefault&&t.preventDefault()},this.addEvent(t,"click",i),this.addEvent(t,"contextmenu",i)},t.prototype.trim=function(t){return t.replace(/^\s+|\s+$/g,"")},t.prototype.getOverlaySize=function(t,e,i){var o,n,r,s,l,a,h;for(h=document.createElement("div"),h.innerHTML=t,h.style.visibility="hidden",h.style.display="inline-block",h.style.width=i+"px",o=h.querySelectorAll("span"),r=0,s=o.length;s>r;r++)a=o[r],n=parseInt(a.style.fontSize||12),a.style.fontSize=n+e+"px";return document.body.appendChild(h),l=[h.clientWidth,h.clientHeight],document.body.removeChild(h),l},t.prototype.getMaxSpanFontSizeFromWrapper=function(t){var e,i,o,n,r,s;for(s=t.querySelectorAll("span"),n=0,i=0,o=s.length;o>i;i++)r=s[i],e=parseInt(r.style.fontSize),e>n&&(n=e);return n},t.prototype.addFallBackFont=function(t){var e,i;return e="sans-serif",i=t,null==t||""===t.trim()?i=e:t.indexOf(e)<0&&(i=t+", "+e),i},t}(),g=function(t){function e(){e.__super__.constructor.call(this),this.saleStickerWidth=this.option.get("saleStickerWidth"),this.saleStickerContents=this.option.get("saleStickerContents"),this.saleStickerImg=this.option.get("saleStickerImg"),this.transparent="rgba(0, 0, 0, 0)",this.saleStickerColor=this.isImageSticker()?this.transparent:this.option.get("saleStickerColor"),this.showSaleSticker=this.option.get("showSaleSticker"),this.prefix=this.option.get("saleStickerContentPrefix")||"",this.appendix=this.option.get("saleStickerContentAppendix")||"",this.fontFamily=this.option.get("saleStickerFontFamily"),this.position=this.option.get("saleStickerPosition"),this.autoCalc=this.option.get("saleStickerAutoCalc"),this.hasSetSytle=!1}return C(e,t),e.prototype.createSticker=function(t,e){var i,o,n;return n=document.createElement("div"),n.className=this.stickerClassName(),i=document.createElement("span"),i.className=this.stickerContentClassName(),this.option.get("saleStickerImg").length>0?(o=document.createElement("img"),o.src=this.option.get("saleStickerImg"),o.style.width=i.appendChild(o)):i.innerHTML=this.saleStickerContents.length>e?this.generateContent(e):"",t.appendChild(n),t.appendChild(i)},e.prototype.prepareAutoStickerContent=function(){var t,e,i,o,n,r,s;if(null!=this.option.get("content")&&null!=this.option.get("content").map.price&&null!=this.option.get("content").map.listprice){for(r=this.option.get("content").map.price[0],o=this.option.get("content").map.listprice[0],this.saleStickerContents=[],e=0,s=[];e<r.length;)n=parseFloat(r[e]),i=parseFloat(o[e]),t="",""!==r[e]&&""!==o[e]&&i>n&&(t=Math.round((i-n)/i*100),t+="%"),this.saleStickerContents.push(t),s.push(e++);return s}},e.prototype.generateContent=function(t){return this.helper.trim([this.prefix,this.saleStickerContents[t],this.appendix].join(" "))},e.prototype.getLongestContent=function(){var t,e;if(e="",this.saleStickerContents.length>0)for(t=0;t<this.saleStickerContents.length;)this.saleStickerContents[t].length>e.length&&(e=this.saleStickerContents[t]),t++;return this.helper.trim([this.prefix,e,this.appendix].join(" "))},e.prototype.stickerClassName=function(){return"sale-sticker"},e.prototype.stickerContentClassName=function(){return"sale-sticker-content"},e.prototype.setStickerStyle=function(t,e){var i,o,n,r,s,l,a,h;return this.option.attrIsConfigured("saleStickerWidth")||(this.saleStickerWidth=Math.min(t,e)/3),l=this.calculateStickerRealSize(),this.style.content+="."+this.stickerClassName()+" { background: "+this.saleStickerColor+"; width: "+this.saleStickerWidth+"px; height: "+this.saleStickerWidth+"px; text-align: center; position: absolute;",this.style.content+=this.positionStyle(l),this.style.content+="} ."+this.stickerClassName()+":before, ."+this.stickerClassName()+":after { content: ''; position: absolute; top: 0; left: 0; height: "+this.saleStickerWidth+"px; width: "+this.saleStickerWidth+"px; background: "+this.saleStickerColor+"; } ."+this.stickerClassName()+":before { -webkit-transform: rotate(30deg); -moz-transform: rotate(30deg); -ms-transform: rotate(30deg); -o-transform: rotate(30deg); } ."+this.stickerClassName()+":after { -webkit-transform: rotate(60deg); -moz-transform: rotate(60deg); -ms-transform: rotate(60deg); -o-transform: rotate(60deg); }",(this.saleStickerContents.length>0||this.saleStickerImg.length>0)&&(0!==this.option.get("saleStickerFontSize")?(o=this.option.get("saleStickerFontSize"),a=this.calcuateFontSizeWithFixedAttributes(this.getLongestContent(),this.saleStickerWidth,this.saleStickerWidth,this.fontFamily,this.fontSize),i=a[0],r=a[1]):(h=this.calcuateFontSizeWithFixedAttributes(this.getLongestContent(),this.saleStickerWidth,this.saleStickerWidth,this.fontFamily),o=h[0],r=h[1]),0!==this.option.get("saleStickerLineHeight")?(n=this.option.get("saleStickerLineHeight"),s=(this.saleStickerWidth-n*r)/2):(n=this.saleStickerWidth/r,s=0),this.style.content+="."+this.stickerContentClassName()+"{ z-index: 2; position: absolute; font-family: "+this.helper.addFallBackFont(this.fontFamily)+"; color: "+this.option.get("saleStickerTextColor")+"; width: "+this.saleStickerWidth+"px; height: "+this.saleStickerWidth+"px; display: inline-block; text-align: center; letter-spacing: 1px; font-size: "+o+"px; word-wrap: break-word; box-sizing: border-box; line-height: "+n+"px;",0===this.option.get("saleStickerImg").length&&(this.style.content+="padding-top: "+s+"px;"),this.isImageSticker()?this.style.content+=this.positionStyle():this.style.content+=this.positionStyle(l),this.style.content+="}",this.style.content+="."+this.stickerContentClassName()+" img{ width: "+this.saleStickerWidth+"px; height: "+this.saleStickerWidth+"px; }"),this.hasSetSytle=!0},e.prototype.calculateStickerRealSize=function(){return(1+Math.sqrt(3))/2*this.saleStickerWidth},e.prototype.calcuateFontSizeWithFixedAttributes=function(t,e,i,o,n){var r,s,l,a;if(a=t.split(" ").length,l=(Math.sqrt(3)-1)/4*e,s=document.createElement("div"),s.style.width=e+"px",s.innerHTML=t,s.position="absolute",s.style.fontFamily=o,s.style.wordWrap="break-word",s.style.letterSpacing="1px",document.body.appendChild(s),null==n){for(n=1,s.style.fontSize=n+"px";s.clientHeight<=i;)n++,s.style.fontSize=n+"px";s.clientHeight-i>l&&--n}return s.style.fontSize=n+"px",r=Math.floor(s.clientHeight/n),document.body.removeChild(s),[n,r]},e.prototype.positionStyle=function(t){var e;switch(null==t&&(t=this.saleStickerWidth),e=(t-this.saleStickerWidth)/2,this.position){case"topLeft":return"top: "+e+"px; left: "+e+"px;";case"topRight":return"top: "+e+"px; right: "+e+"px;";case"bottomLeft":return"bottom: "+e+"px; left: "+e+"px;";case"bottomRight":return"bottom: "+e+"px; right: "+e+"px;"}},e.prototype.isImageSticker=function(){return this.saleStickerImg.length>0},e}(t),e=function(t){function e(){e.__super__.constructor.call(this),this.hasSetStyle=!1}return C(e,t),e.prototype.setCTAStyle=function(t){return this.style.content+=t+"{ display: inline-block; padding: 4px; margin: 1px; background-color: "+this.option.get("ctaBgColor")+"; color: "+this.option.get("ctaTextColor")+"; font-family: "+this.helper.addFallBackFont(this.option.get("ctaTextFamily"))+"; font-size: "+this.option.get("ctaTextSize")+"px; width: "+this.option.get("ctaWidth")+"px; border-radius: "+this.option.get("ctaRadius")+"px; border-width: "+this.option.get("ctaBorderWidth")+"px; border-color: "+this.option.get("ctaBorderColor")+"; border-style: "+this.option.get("ctaBorderStyle")+"; }",this.style.content+=t+":hover{ background-color: "+this.option.get("ctaBgHoverColor")+"; }"},e.prototype.createCTA=function(t){var e,i;return this.hasSetStyle||(this.setCTAStyle("div."+this._ctaClassName()),this.hasSetStyle=!0),e=document.createElement("div"),e.className=this._ctaClassName(),t>=0&&(e.id="cta-"+t),i=document.createElement("span"),i.innerHTML=this.option.get("ctaText"),e.appendChild(i),e},e.prototype.getCTAHeight=function(t,e){var i,o;return e?(o=document.createElement("div"),o.style.width=t+"px",o.appendChild(this.createCTA()),document.getElementById("stage").appendChild(o),i=o.clientHeight+2,document.getElementById("stage").removeChild(o),i):0},e.prototype.willCTAshow=function(t,e,i,o,n){return t&&e+4*n<o[0]&&i+4*n<o[1]},e.prototype.getTotalCtaWidth=function(t){return t+8+4},e.prototype._ctaClassName=function(){return"rf-cta"},e}(t),s=function(t){function i(){i.__super__.constructor.call(this),this.ctaClass=new e,this.isInProds="inProds"===this.option.get("logoPosition"),this.elementBeginIndex=this.isInProds?1:0,this.curAnimatingElement=this.elementelementBeginIndex,this.showNonPriceText=!0,this.sticker=new g}return C(i,t),i.prototype.generateGrid=function(t,e,i,o,n,r,s,l,a,h,c,p,d,g,u,m,y,f,x,C,v,S){return this.option.hasProperty("landingUrls")?(this._checkAndPopulateContent(),this._checkAndPopulateProdIDs(),this._checkPopulatedProdCount(),this.createGridElements(t,a,l,h,c,p,d,S,i,o,e,n,g,u,m,y,r,s),this.makeGrid(f,i,o,r,s,n,this.option.get("bgColor"),x,C,v,g,u,S)):void 0},i.prototype.makeGrid=function(t,e,i,o,n,r,s,l,a,h,c,p,d){var g,u,m,y,f,x,C,v,S,b,w,k,I,E,T,P,_,H,F,A,D,B,L,M;for(b=this.option.get("currFormat"),g=this.option.getInteger("animationFrameMillis"),u=this.option.getInteger("animationMaxSecs"),T=this.createGridElement(e,i,o,n,r,s),this.setHoverStyle("."+this._autoHoverClassName(),g,l,a),this.setHoverStyle("."+this._mouseHoverClassName(),g,"",""),t.appendChild(T),x=0,v=0,H=(n-r)/this.rows-2*this.option.get("borderWidth")-r,P=Math.floor((H-Math.floor(H))*this.rows/1),this.splitPercentage=.5,_=0;_<this.elements.length&&(this.logger.log("Creating grid "+_),0===x&&(S=document.createElement("tr"),S.id="row"+v,T.appendChild(S)),C=this.elements[_],f=document.createElement("td"),f.style.position="relative",f.id="cell_"+_,"image-next-to-text"===this.option.get("gridStyle")?(E=this.option.get("splitPercentage"),null!=E&&(E=parseFloat(E)),this.splitPercentage=this.calculateBestPercentage(E),this.splitModeImageLoc=this.option.get("splitModeImageLoc"),L=document.createElement("div"),L.style.position="relative",L.className="wrapperLeftOrTop",L.style.display="inline-block",M=document.createElement("div"),M.style.position="relative",M.style.verticalAlign="bottom",M.className="wrapperRightOrBottom",M.style.display="inline-block",this.updateOneCellPercentage(L,M,this.splitPercentage),f.appendChild(L),f.appendChild(M),"left"===this.splitModeImageLoc||"top"===this.splitModeImageLoc?(F=L,A=M):("right"===this.splitModeImageLoc||"bottom"===this.splitModeImageLoc)&&(F=M,A=L)):(m=document.createElement("div"),m.style.position="relative",m.style.width="100%",y=this.cellDim[1],null!=this.elements[_].borderWidth&&(y-=2*this.elements[_].borderWidth),m.style.height=y+"px",F=A=m,f.appendChild(m)),P>0?this.setCellElementStyle("#"+f.id,C,Math.floor(H)+1):this.setCellElementStyle("#"+f.id,C,Math.floor(H)),_>=this.elementBeginIndex&&(f.onmouseenter=function(t){
return function(e,i){return function(){return t.curAnimatingElement>0&&t.endHover(t.curAnimatingElement-1,i[t.curAnimatingElement-1],d),null!=window.rocketfuel.curAnimationInterval&&(window.clearInterval(window.rocketfuel.curAnimationInterval),t.stopOverlay()),t.startHover(e,i[e],d,""+t._mouseHoverClassName())}}}(this)(_,this.elements),f.onmouseleave=function(t){return function(e,i){return function(){return t.endHover(e,i[e],d),t.curAnimatingElement=e+1,null!=window.rocketfuel.curAnimationFunction&&(window.rocketfuel.curAnimationInterval=window.setInterval(window.rocketfuel.curAnimationFunction,t.curAnimationFrameMillis)),t.mouseHoverActive=!1}}}(this)(_,this.elements)),C.hasOwnProperty("clkUrl")&&"never"!==d&&(k=document.createElement("div"),k.id="element_"+_+"_overlay",k.style.visibility="hidden",this.helper.addClass(k,""+this._rfElementOverlayClassName()),this.helper.addClass(k,"hidden"),k.margin="auto",k.align=this.option.get("overlayAlign"),k.style.boxSizing="border-box",this.setElementOverlayStyle("#"+k.id,C,d,this.cellDim),""!==C.content&&(B=this.option.get("textAreaWidth"),I=document.createElement("div"),I.id="element_"+_+"_text_area",I.style.display="table",I.style.textAlign="center",I.style.borderCollapse="collapse","right"===this.option.get("overlayAlign")&&(I.style.left=parseInt(this.cellDim[0])-parseInt(B)+"px"),D="image-next-to-text"===this.option.get("gridStyle")?"100%":"full"===B?"100%":B+"px",I.style.width=D,w=document.createElement("div"),w.style.display="table-cell",w.style.verticalAlign=this.option.get("textVertAlign"),w.style.textAlign="center",w.style.color="black",w.innerHTML=C.content,I.appendChild(w),k.appendChild(I)),c&&this.ctaClass.getTotalCtaWidth(p)<this.cellDim[0]&&this.cellDim[1]>50&&k.appendChild(this.ctaClass.createCTA(_)),A.appendChild(k)),this.sticker.autoCalc&&this.sticker.prepareAutoStickerContent(),this.sticker.showSaleSticker&&null!=this.sticker.saleStickerContents[_]&&this.sticker.saleStickerContents[_].length>0&&(this.sticker.createSticker(f,_),this.sticker.hasSetSytle||this.sticker.setStickerStyle(this.cellDim[0],this.cellDim[1])),S.appendChild(f),this.populateImageOnCell(C,f,H,h,F),x++,P-=1,!(x>=this.cols&&(x=0,v++,v>=this.rows)));)_++;return g>0&&_<this.elements.length?(window.rocketfuel.curAnimationFunction=this.generateHoverFunction(_,this.elements,(new Date).getTime(),u,l,a,d),"undefined"!=typeof window.rocketfuel.curAnimationInterval&&(window.clearInterval(window.rocketfuel.curAnimationInterval),this.stopOverlay()),this.curAnimatingElement=this.elementBeginIndex,window.rocketfuel.curAnimationInterval=window.setInterval(window.rocketfuel.curAnimationFunction,g),this.curAnimationFrameMillis=g):void 0},i.prototype.populateImageOnCell=function(t,e,i,o,n){var r,s,l,a,h,c,p,d,g,u,m;return a=document.createElement("img"),n.appendChild(a),r=t.boundingBox,null!=document.location.origin&&"null"!==document.location.origin&&"file://"!==document.location.origin&&(t.img=t.img),a.style.maxHeight="100%",a.style.maxWidth="100%","image-with-text-overlay"===this.option.get("gridStyle")?(l=this.cellDim[0],s=this.cellDim[1]):"image-next-to-text"===this.option.get("gridStyle")&&(l=parseInt(n.style.width)/100*this.cellDim[0],s=parseInt(n.style.height)/100*this.cellDim[1]),h=this.helper.getImageDims(l,s,r),c=h[0]/h[1],u=l/c,m=c*s,p=this.option.get("innerPadding"),"cover"===o?u>s?(a.style.width=l+"px",a.style.maxHeight="",a.style.height=u+"px",a.style.position="absolute",a.style.left="0px",d=Math.abs((u-s)/2),a.style.top=-1*d+"px",a.style.clip="rect("+d+"px, "+l+"px, "+(s+d)+"px, 0)"):m>l&&(a.style.height=s+"px",a.style.maxWidth="",a.style.width=m+"px",a.style.position="absolute",a.style.top="0px",d=Math.abs((m-l)/2),a.style.left=-1*d+"px",a.style.clip="rect(0, "+(l+d)+"px, "+s+"px, "+d+"px)"):(a.style.position="absolute",a.style.verticalAlign="middle",m>l?(a.style.width=(l-2*p)/l*100+"%",a.style.height="auto",a.style.top=(s-(l-2*p)/c)/2+"px",a.style.left=p+"px"):(a.style.width="auto",a.style.height=(s-2*p)/s*100+"%",a.style.left=(l-c*(s-2*p))/2+"px",a.style.top=p+"px")),r&&"x1"in r&&"x2"in r&&"y1"in r&&"y2"in r&&this.option.get("useOrigImgs")===!1&&!this.option.get("textOnly")?(g=t.img.split("/"),a.src=""+this.helper.calculateBGImage(g,r)):a.src=""+t.img,this.setCellImageStyle("#"+e.id,o,i),this.helper.hijackLinkElement(e,t.clkUrl)},i.prototype.createGridElements=function(t,e,i,o,n,r,s,l,a,h,c,p,d,g,u,m,y,f){var x,C,v,S,b,w,k;for(this.calcGridDimension(t,c,a,h,p,y,f,d,g),this.ctaHeight=this.ctaClass.getCTAHeight(t/this.cols,d)+4,e&&this.elements.push({img:i,clkUrl:o+encodeURIComponent(n)}),C=this.elementBeginIndex,x=this.option.get("borderPolicy"),this.cellDim=this.calcCellWidthAndHeight(y,f,this.rows,this.cols,p),k=[];C<this.rows*this.cols;)v=this.option.get("textOnly")?"//c2.rfihub.net/static/img/grid/resources/blank1x1.gif":this.option.get("images")[0][C][0],S=this.option.get("landingUrls")[0][C],w="?dc_params=pid:"+this.option.get("productID")[0][C],b={img:v,clkUrl:o+encodeURIComponent(r+S+s+w),boundingBox:this.boundingBoxes[0][C]},"never"!==l&&(b.content=this.fitContent(C,g,this.ctaHeight,this.prodBorderWidth)),this.prodBorderWidth>0&&(b.borderWidth=this.prodBorderWidth,b.borderColor=u,b.borderStyle=this.option.get("borderStyle"),b.borderHoverColor=m,b.borderPolicy=x),this.elements.push(b),k.push(C++);return k},i.prototype.getPricesHTML=function(t,e,i,o,n,r,s,l,a,h){var c,p,d,g,u,m,y,f,x,C,v,S;if(S="",m=t.display,c=["price","listprice"],v=this.helper.getPriceListprice(t,o),e=this.helper.getPriceLocale(t,o)||e,v[0]>0){for(f=this.helper.getIndexesOf("<span",m),u=this.helper.getIndexesOf("</span",m),g=0;g<u.length;)u[g]=this.helper.findFirstCharDistance(">",m,u[g])+1,g++;y=m.toLowerCase().indexOf("["+c[1]+"]"),x=this.helper.getPriceHTML(m,v[0],e,i,c[0],f,u,y),C=this.getTextWidthAndHeight(x,s[0],l),null!=v[1]&&v[1]>0&&-1!==y?(p=this.helper.getBothPricesHTML(m,v,e,i,c,f,u),d=this.getTextWidthAndHeight(p,s[0],l),d[0]<n&&d[1]<r?S=p:C[0]<n&&C[1]<r&&(S=x)):C[0]<n&&C[1]<r&&(S=x)}else S="";return S},i.prototype.createGridElement=function(t,e,i,o,n,r){var s;return s=document.createElement("table"),s.id="grid",s.cellSpacing=n+"px",this.setGridElementStyle("#"+s.id,t,e,i,o,r),s},i.prototype.fitContent=function(t,e,i,o){var n,r,s,l,a,h,c,p,d,g,u,m,y;return d=this.option.get("padding"),m=this.option.get("showCTA"),n=this.option.get("content"),p=1,a=this.option.get("currFormat"),h=this.option.get("innerPadding"),l=this.ctaClass.willCTAshow(m,e,i,this.cellDim,d),r=l?this.cellDim[1]-2*d-i-2*p:this.cellDim[1]-2*d-2*p,r-=2*h,s=this.cellDim[0]-2*d-2*(o>0?0:1),s-=2*h,"image-next-to-text"===this.option.get("gridStyle")&&(y=this.option.get("splitModeImageLoc"),"left"===y||"right"===y?s*=.6:("top"===y||"bottom"===y)&&(r*=.6)),u=this.getPricesHTML(n,this.option.get("locale"),a,t,s,r,this.cellDim,d,l,e),g=this.getTextWidthAndHeight(u,this.cellDim[0],d)[1],r-=g,c=this.helper.closeHTMLtag(this.fitOtherText(n,u,s,r,d,l,e,t,this.cellDim)),""===c&&(this.showNonPriceText=!1),u=c+u},i.prototype.fitOtherText=function(t,e,i,o,n,r,s,l,a){var h,c,p,d,g,u,m,y;if(c="",p=this.helper.parseDisplayStructure(t),g=this.helper.getNumTextElements(p),i>0&&o>0)for(;;){if(d=this.helper.getMaxContentTextEleIndex(t,p,l,g),h=this.helper.getCharLimit(p,d)-1,0>=h)break;if(p=this.helper.updateMaxChar(p,d,h),c=this.helper.getNonPriceHTML(t,p,l),y=this.getTextWidthAndHeight(c,i,n),m=y[0],u=y[1],i>m&&o>u)break}return c},i.prototype.getContentForIndex=function(t,e){var i;return i=this.helper.parseDisplayStructure(t),this.getConstructedHTML(t,i,e)},i.prototype.getConstructedHTML=function(t,e,i){var o,n,r,s,l,a;for(a="",s=0,l=e.length;l>s;s++)r=e[s],a+=r[0],"undefined"!=typeof r[1]&&(n=r[1][0],o="undefined"!=typeof r[1][1]?r[1][1]:0,r[1][0]&&r[1][0].toLowerCase().search("price")>=0?a+=this.helper.getPriceText(t.map[n][0][i],options.locale):o>3&&(a+=this.helper.trimText(t.map[n][0][i],o)));return a},i.prototype.getTextWidthAndHeight=function(t,e,i,o){var n,r,s,l;return null==o&&(o=14),n=document.createElement("div"),n.style.width=e-2*i-2-2*this.prodBorderWidth+"px",n.style.display="inline-block",s=document.createElement("span"),s.style.display="inline-block",s.style.marginLeft=i+"px",s.style.marginRight=i+"px",s.style.fontSize=o+"px",s.innerHTML=t,n.appendChild(s),document.body.appendChild(n),r=s.clientHeight,l=s.offsetWidth,document.body.removeChild(n),[l,r]},i.prototype._checkAndPopulateContent=function(){var t,e,i,o;return this.option.attrIsUndefined("content")&&(e="",o={},i=this.helper.addFallBackFont(""),this.option.attrIsDefined("labels")&&"undefined"!=typeof this.option.get("labels")[0]&&(e+="<span class='rf-cell-label' style='font-family: "+i+";'>[labels,50]</span>",o.labels=this.option.get("labels")),this.option.attrIsDefined("prices")&&"undefined"!=typeof this.option.get("prices")[0]&&(e+="<span class='rf-cell-price' style='font-family: "+i+";'>[price]</span>",o.price=this.option.get("prices")[0]),t={display:e,map:o},this.option.set("content",t)),this.option.get("content").display=this.addFallbackFontToDisplay(this.option.get("content").display)},i.prototype._checkAndPopulateProdIDs=function(){var t,e;if(this.option.attrIsUndefined("productID")){for(t=0,e=[];30>t;)e.push(""),t++;return this.option.set("productID",[e])}},i.prototype._checkPopulatedProdCount=function(){var t,e,i,o;if(t=this.option.get("content"),null==t)return this.prodCountInContent=0;this.prodCountInContent=1e3,i=t.map;for(e in i)o=i[e],this.prodCountInContent=Math.min(this.prodCountInContent,o[0].length);return this.prodCountInContent},i.prototype.addFallbackFontToDisplay=function(t){var e;return e=document.createElement("div"),e.innerHTML=t,this._addFallbackFontForNodes(e.childNodes),e.innerHTML},i.prototype._addFallbackFontForNodes=function(t){var e,i,o,n;if(null!=t){for(n=[],e=0,i=t.length;i>e;e++)o=t[e],null!=o.style&&(o.style.fontFamily=this.helper.addFallBackFont(o.style.fontFamily)),n.push(this._addFallbackFontForNodes(o.childNodes));return n}},i.prototype.getNonBlankArea=function(t,e,i,o,n){var r,s,l;for(l=0,s=0;o*n>s;)r=this.helper.getImageDims(e,i,t[0][s]),l+=r[0]*r[1],s++;return l},i.prototype.setCellElementStyle=function(t,e,i){return this.style.content+=t+"{ padding: 0px; margin: 0px; text-align: center; overflow: hidden; color: #000;",this.option.get("textOnly")||(this.style.content+="height: "+i+"px;"),e.hasOwnProperty("borderWidth")&&(this.style.content+="border-style: "+e.borderStyle+"; border-width: "+e.borderWidth+"px;","always"===e.borderPolicy?this.style.content+="border-color: "+e.borderColor+";":this.style.content+="border-color: white;"),this.style.content+="}"},i.prototype.setElementOverlayStyle=function(t,e,i,o){var n,r;return this.cellWidthAndHeight=o,this.style.content+=t+"{ position: absolute; opacity: 1; margin: auto; left: 0px; margin-left: auto; margin-right: auto; width: 100%; z-index: 3; text-align: center;",n=parseInt(e.borderWidth)>0?0:1,n>0&&""!==e.content&&"image-next-to-text"!==this.option.get("gridStyle")&&(this.style.content+="border: 1px solid "+this.option.get("overlayBorderColor")+";"),"IE8"!==this.helper.checkNavigatorVersion()&&"IE9"!==this.helper.checkNavigatorVersion()||!this.option.get("textBgColor").match(/^rgba/)?this.style.content+="background-color: "+this.option.get("textBgColor")+";":(r=this.option.get("textBgColor"),this.style.content+="background:none; -ms-filter:"+this.helper.convertRGBA2MSStyle(r)+"; filter:"+this.helper.convertRGBA2MSStyle(r)+"; zoom: 1;"),this.style.content+="}"},i.prototype.setElementTextSpanStyle=function(t){return this.style.content+=t+"{ vertical-align: middle; text-align: center; color: black; width: 100%; text-align: center; left: 0; }"},i.prototype.setCellImageStyle=function(t,e,i){var o,n;return n=this.isInProdsLogoCell(t),this.style.content+=t+"{ cursor: pointer; background-color: "+this.option.get("cellBgColor")+";}",!this.option.get("textOnly")||n?(o=document.getElementById(t.substring(1)),this.style.content+=t+" > img{ display: block; border: none; margin: auto;",this.style.content+="}"):void 0},i.prototype.isInProdsLogoCell=function(t){return"#cell_0"===t&&this.isInProds},i.prototype.setGridElementStyle=function(t,e,i,o,n,r){return this.style.content+=t+"{ position: absolute; table-layout: fixed; overflow: hidden; left: "+e+"px; top: "+i+"px; width: "+o+"px; height: "+n+"px; background-color: "+r+"; }"},i.prototype.setHoverStyle=function(t,e,i,o){return o="transform "+e+"ms "+o,this.style.content+=t+"{ transform: "+i+"; transition: "+o+"; -moz-transform: "+i+"; -moz-transition: -moz-"+o+"; -ms-transform: "+i+"; -ms-transition: -ms-"+o+"; -o-transform: "+i+"; -o-transition: -o-"+o+"; -webkit-transform: "+i+"; -webkit-transition: -webkit-"+o+"; }"},i.prototype._autoHoverClassName=function(){return"rf-auto-hover"},i.prototype._mouseHoverClassName=function(){return"rf-mouse-hover"},i.prototype._rfElementOverlayClassName=function(){return"rf-element-overlay"},i}(t),r(s,{calcGridDimension:function(t,e,i,o,n,r,s,l,a){return this._initBoundingBoxes(),this.prodBorderWidth=this.option.getInteger("borderWidth"),this.rows=this.option.get("rows")&&this.option.getInteger("rows"),this.cols=this.option.get("cols")&&this.option.getInteger("cols"),null==this.rows||null==this.cols||this.rows*this.cols>this.prodCountInContent?(this.dimensions=[1,1],this.option.get("textOnly")?this._calcTextOnlyGridDimension(t,e,i,o,n,r,s,l,a):this._calcHasBgGridDimension(t,e,i,o,n,r,s),this.rows=this.dimensions[0],this.cols=this.dimensions[1]):void 0},_initBoundingBoxes:function(){var t,e,i;for(this.boundingBoxes=[[]],e=0,i=[];e<this.option.get("boundingBoxes")[0].length;)t=this.option.get("boundingBoxes")[0][e][0]||"{}",this.boundingBoxes[0].push(x(t)),i.push(e++);return i},_calcHasBgGridDimension:function(t,e,i,o,n,r,s){var l,a,h,c,p;return p=Math.min(r-2*n,this.option.getInteger("minCellWidth")),h=Math.max(p,this.option.getInteger("maxCellWidth")),c=Math.min(s-2*n,this.option.getInteger("minCellHeight")),a=Math.max(c,this.option.getInteger("maxCellHeight")),l={minW:p,maxW:h,minH:c,maxH:a},this.dimensions=this._calcRowsAndCols(this.boundingBoxes,r,s,l,n,this.prodBorderWidth,this.option.get("landingUrls")[0].length)},_calcTextOnlyGridDimension:function(t,e,i,o,n,r,s,l,a){var h,c,p,d,g,u,m,y,f,x,C,v,S,b,w;for(c=0;c<this.option.get("landingUrls")[0].length;)this.boundingBoxes[0].push([{y1:1,x1:1,y2:3,x2:2}]),c++;for(p=1,x=this.option.get("productID")[0].length,f=100,y=this.option.get("minCellWidth"),u=this.option.get("maxCellWidth"),m=this.option.get("minCellHeight"),g=this.option.get("maxCellHeight"),v=[];x>=p*p;){for(S=h=p,b=!0;x>=S*h;){if(this.cellDim=this.calcCellWidthAndHeight(r,s,S,h,n),this.cellDim[0]<=u&&this.cellDim[0]>=y&&this.cellDim[1]<=g&&this.cellDim[1]>=m&&(C=this._testContentTruncated(t,e,i,o,n,r,s,l,a,S,h),d=C[0],w=C[1],f>w&&"blank"!==d&&(this.dimensions=[S,h],w>0&&(f=w)),d||"blank"===d)){if(!b)break;b=!1,S=p}b?S++:h++}v.push(p++)}return v},_testContentTruncated:function(t,e,i,o,n,r,s,l,a,h,c){var p,d,g,u,m;for(g=0,m=0,u=!1;h*c>g;){if(d=this.ctaClass.getCTAHeight(t/c,l)+4,p=this.fitContent(g,a,d,this.prodBorderWidth),""===p)return this.helper.clearCachedDisplayStructure(),["blank",h*c];p.indexOf("...")>0&&(u=!0,m++),g++}return this.helper.clearCachedDisplayStructure(),[u,m]},calcCellWidthAndHeight:function(t,e,i,o,n){var r,s;return s=this.getCellWidth(t,o,n),r=this.getCellHeight(e,i,n),[s,r]},_calcRowsAndCols:function(t,e,i,o,n,r,s){var l,a,h,c,p,d,g,u,m,y,f,x,C,v,S,b,w,k,I;for(k=[1,1],l=0,y=this.option.getInteger("minCell"),g=Math.min(s,this.option.getInteger("maxCell")),C=35e3>=e*i?!0:!1,m=100>i?2:8,u=8,b=this._updateRowLimit(i,o,n,m),x=b[0],m=b[1],w=this._updateColLimit(e,o,n,u),f=w[0],u=w[1],S=x;m>=S;){for(a=f;u>=a;)I=S*a,p=this.calcCellWidthAndHeight(e,i,S,a,n),c=p[0],h=p[1],d=I>=y&&g>=I&&(S>1||a>1||C),d&&(v=this.getNonBlankArea(t,c,h,S,a),v>l&&(l=v,k=[S,a])),a++;S++}return k},_updateRowLimit:function(t,e,i,o){var n,r;return r=n=0,r=Math.max(Math.floor((t-i)/(e.maxH+i)),1),n=Math.min(Math.floor((t-i)/(e.minH+i)),o),[r,n]},_updateColLimit:function(t,e,i,o){var n,r;return r=n=0,r=Math.max(Math.floor((t-i)/(e.maxW+i)),1),n=Math.min(Math.floor((t-i)/(e.minW+i)),o),[r,n]},getCellWidth:function(t,e,i){return Math.round((t-(e+1)*i)/e)},getCellHeight:function(t,e,i){return Math.round((t-(e+1)*i)/e)},calculateBestPercentage:function(t){var e,i,o,n,r,s,l,a,h,c,p,d,g,u,m,y,f,x,C,v,S,b,w,k,I,E,T,P,_,H,F,A,D,B,L,M,z,W,N;for(this.splitModeImageLoc=this.option.get("splitModeImageLoc"),i=this.option.get("backgroundImageSize"),x=this.option.get("innerPadding"),a=this.cellDim[0]-2*x,l=this.cellDim[1]-2*x,W=this.option.getFloat("autoScalePercentage"),n=100,r=.5,P=null!=t?t:.4,k=null!=t?t:.7,I=1e6,o=this.option.get("boundingBoxes");k>=P;){switch(u=0,this.splitModeImageLoc){case"left":case"right":if("contain"===i){for(g=0;g<this.elements.length;)m=this.helper.getImageDims(a,l,o[0][g]),y=m[0]/m[1],f=a*P/l,f>y&&(u+=a*P-l*y),g++;u=Math.max(0,u)}for(H=this.elements,C=0,v=H.length;v>C;C++)h=H[C],F=this.getEachBestFontSize(a*(1-P),l,h.content),c=F[0],p=F[1],n=Math.min(n,c);for(s=0,A=this.elements,E=0,S=A.length;S>E;E++)h=A[E],D=this.helper.getOverlaySize(h.content,n,a*(1-P)),N=D[0],e=D[1],s+=a*(1-P)-N+u;(I>s&&s>=0||null!=t)&&(I=s,r=P,this.bestFontSizeIncreseOffset=n);break;case"top":case"bottom":if("contain"===i){for(g=0;g<this.elements.length;)m=this.helper.getImageDims(a,l,o[0][g]),y=m[0]/m[1],f=a*P/l,y>f&&(u+=l*P-a/y),g++;u=Math.max(0,u)}for(B=this.elements,T=0,b=B.length;b>T;T++)h=B[T],L=this.getEachBestFontSize(a,l*(1-P),h.content),c=L[0],p=L[1],n=Math.min(n,c);for(s=0,M=this.elements,_=0,w=M.length;w>_;_++){if(h=M[_],z=this.helper.getOverlaySize(h.content,n,a),e=z[0],d=z[1],d+=this.ctaHeight+n,0>l*(1-P)-d){s=-1;break}s+=l*(1-P)-d+u}(I>s&&s>=0||null!=t)&&(I=s,r=P,this.bestFontSizeIncreseOffset=n)}P+=.05}return this.fontSizeNeedChange=p,r},transformToPercentageWithoutInnerPadding:function(t,e){var i;return i=this.option.get("innerPadding"),"horizental"===e?t*(this.cellDim[1]-2*i)/this.cellDim[1]:"vertical"===e?t*(this.cellDim[0]-2*i)/this.cellDim[0]:void 0}}),r(s,{startHover:function(t,e,i,o){var n,r;return n=document.getElementById("cell_"+t),"never"!==i&&(r=document.getElementById("element_"+t+"_overlay"),r.style.visibility="",r.style.color="",this.option.get("hoverUnderline")&&(r.style.textDecoration="underline")),"IE8"===this.helper.checkNavigatorVersion()||"IE9"===this.helper.checkNavigatorVersion()?n.style.borderColor=this.helper.convert2RGBColor(e.borderHoverColor):n.style.borderColor=e.borderHoverColor,this.helper.addClass(n,o)},stopOverlay:function(t){return function(){return window.clearInterval(window.rocketfuel.overlayInterval)}}(this),generateHoverFunction:function(t,e,i,o,n,r,s){return function(n){return function(){return n.curAnimatingElement>t?n.endHover(t,e[t],s):n.curAnimatingElement>n.elementBeginIndex&&n.endHover(n.curAnimatingElement-1,e[n.curAnimatingElement-1],s),isNaN(o)||0>=o||(new Date).getTime()-i<1e3*o?t===n.elementBeginIndex&&n.curAnimatingElement>n.elementBeginIndex?n.curAnimatingElement=n.elementBeginIndex:(n.curAnimatingElement>t&&(n.curAnimatingElement=n.elementBeginIndex),n.mouseHoverActive?void 0:(n.startHover(n.curAnimatingElement,e[n.curAnimatingElement],s,""+n._autoHoverClassName()),n.curAnimatingElement++)):(window.clearInterval(window.rocketfuel.curAnimationInterval),n.stopOverlay())}}(this)},endHover:function(t,e,i){var o,n;return o=document.getElementById("cell_"+t),null!==o&&("hover"===e.borderPolicy?o.style.borderColor="white":"IE8"===this.helper.checkNavigatorVersion()||"IE9"===this.helper.checkNavigatorVersion()?o.style.borderColor=this.helper.convert2RGBColor(e.borderColor):o.style.borderColor=e.borderColor),n=document.getElementById("element_"+t+"_overlay"),null!==n&&("always"!==i&&(n.style.visibility="hidden"),this.option.get("hoverUnderline")&&(n.style.textDecoration="")),this.helper.removeClass(o,""+this._autoHoverClassName()),this.helper.removeClass(o,""+this._mouseHoverClassName())}}),r(s,{updateOneCellPercentage:function(t,e,i){var o,n,r,s,l,a;switch(o=this.option.get("borderWidth"),s=this.option.get("innerPadding"),l=this.transformToPercentageWithoutInnerPadding(i,"vertical"),a=this.transformToPercentageWithoutInnerPadding(1-i,"vertical"),n=this.transformToPercentageWithoutInnerPadding(i,"horizental"),r=this.transformToPercentageWithoutInnerPadding(1-i,"horizental"),this.option.get("splitModeImageLoc")){case"left":return t.style.width=100*l+"%",t.style.top=o+"px",t.style.height="100%",e.style.width=100*a+"%",e.style.height="100%",e.style.top=o+"px";case"right":return t.style.width=100*a+"%",t.style.height="100%",e.style.width=100*l+"%",e.style.height="100%",t.style.top=o+"px",e.style.top=o+"px";case"top":return t.style.width="100%",t.style.height=100*n+"%",t.style.verticalAlign="top",e.style.width="100%",e.style.height=100*r+"%",t.style.top=o+"px";case"bottom":return t.style.top=o+"px",t.style.width="100%",t.style.verticalAlign="top",t.style.height=100*r+"%",e.style.width="100%",e.style.height=100*n+"%",e.style.top=o+"px"}},updateImageStyle:function(t,e,i,o){var n,r,s,l;return n=this.option.get("backgroundImageSize"),s=e/o,l=o*i,"cover"!==n?(t.style.position="absolute",t.style.verticalAlign="middle",l>e?(t.style.width="100%",t.style.height="auto",t.style.top=(i-e/o)/2+"px",t.style.left="0px"):(t.style.width="auto",t.style.height="100%",t.style.left=(e-o*i)/2+"px",t.style.top="0px")):s>i?(t.style.width=e+"px",t.style.maxHeight="",t.style.height=s+"px",t.style.position="absolute",t.style.left="0px",r=Math.abs((s-i)/2),t.style.top=-1*r+"px",t.style.clip="rect("+r+"px, "+e+"px, "+(i+r)+"px, 0)"):l>e?(t.style.height=i+"px",t.style.maxWidth="",t.style.width=l+"px",t.style.position="absolute",t.style.top="0px",r=Math.abs((l-e)/2),t.style.left=-1*r+"px",t.style.clip="rect(0, "+(e+r)+"px, "+i+"px, "+r+"px)"):void 0},allOverlayFontLoaded:function(){var t,e,o,n,r,s,l,a;if(n=document.getElementById("element_0_text_area"),null!=n){for(o=n.childNodes[0].children,this.fonts=this.fonts||[],0===this.fonts.length&&(t=function(e){return function(i){var o,n,r,s,l;for(l=[],r=0,s=i.length;s>r;r++)o=i[r],null!=o.style.fontFamily?(n=o.style.fontFamily.split(",")[0].trim(),n=n.replace(/['"]+/g,""),-1===e.fonts.indexOf(n)&&e.fonts.push(n),null!=o.children&&o.children.length>0?l.push(t(o.children)):l.push(void 0)):l.push(void 0);return l}}(this))(o),a=this.fonts,s=0,l=a.length;l>s;s++)if(r=a[s],e=new i,!e.detect(r))return!1;return!0}},fitGridWidthAndHeight:function(){var t,e,i,o,n,r,s;return this.option.get("autoScaleFonts")&&this.scaleFontSize(),null!=this.ctaHeight&&this.ctaHeight>0&&null!=this.bestFontSizeIncreseOffset&&(this.ctaHeight+=this.bestFontSizeIncreseOffset),r=this.option.get("showContent"),e="true"===this.option.get("cellFullOverlay")||this.option.get("cellFullOverlay")===!0,o=this.option.get("gridStyle"),s=this.option.get("splitModeImageLoc"),t=this.option.get("borderWidth"),this.setOverlayWidth(),this.setTallestOverlay(r,e,o,s),this.fitOverlayContent(),n=document.getElementById("outerStage"),this.prodCountInContent>0&&(n.style.visibility=""),i=document.getElementById("grid"),i.style.emptyCells="hide"},fitOverlayContent:function(t){return null==t&&(t=0),this.allOverlayFontLoaded()||15>=t?this.checkAndFitOverlayContent():setTimeout(function(e){return function(){return e.fitOverlayContent(t+1)}}(this),100)},checkAndFitOverlayContent:function(){var t,e,i,o,n,r,s,l;for(s=this.option.get("showContent"),o=this.option.get("gridStyle"),e=this.option.get("ctaWidth"),n=0;n<this.elements.length;)if(t=document.getElementById("cell_"+n),r=document.getElementById("element_"+n+"_overlay"),l=document.getElementById("element_"+n+"_text_area"),null!=t&&null!=r&&null!=l){if(t.clientHeight<r.clientHeight){if(i=l.childNodes[0],null==i)break;i.innerHTML=this.fitContent(n,e,this.ctaHeight,this.prodBorderWidth)}n++}else n++;for(n=0;n<this.elements.length;)r=document.getElementById("element_"+n+"_overlay"),this.helper.removeClass(r,"hidden"),n++;return this.positionOverlay(o,s)},positionOverlay:function(t,e){var i,o,n,r;for(n=0,i="image-with-text-overlay"===t?this.option.get("cellVertAlign"):"middle",r=[];n<this.elements.length;){if(o=document.getElementById("element_"+n+"_overlay"),null!=o){switch(i){case"top":o.style.top="0px";break;case"middle":o.style.top="50%",o.style.marginTop="-"+o.clientHeight/2+"px";break;case"bottom":o.style.bottom="0px"}"always"===e&&(o.style.visibility="")}r.push(n++)}return r},setOverlayWidth:function(){var t,e,i,o,n,r;if(!this.option.get("cellFullOverlay")&&"cover"!==this.option.get("backgroundImageSize")){for(i=0,o=this.option.get("innerPadding"),r=[];i<this.elements.length;)t=document.getElementById("cell_"+i),e=t.clientWidth,n=document.getElementById("element_"+i+"_overlay"),n.style.width=n.clientWidth-2*o+"px",n.style.left=o+"px",r.push(i++);return r}},getTallestTextArea:function(t){var e,i,o,n,r;for(i=0,o=0;i<this.elements.length;)n=document.getElementById("element_"+i+"_text_area"),null!=n&&(e=n.childNodes[0],r=Math.ceil((t-e.clientHeight)/3*2+e.clientHeight),o=Math.max(o,r)),i++;return o},setTallestOverlay:function(t,e,i,o){var n,r,s,l,a,h,c,p,d,g,u,m,y,f,x;if("never"!==t){if(f=0,this.showNonPriceText||this.helper.clearNonPriceText(options.content),e){if(this.elements.length>0){for(d=0,f=0;d<this.elements.length;)p=document.getElementById("cell_"+d).parentNode.clientHeight,f=Math.max(f,p),d++;null!=this.ctaHeight&&(f=f-this.ctaHeight+2)}}else if("image-next-to-text"===i)"left"===o||"right"===o?f=document.querySelector("#cell_0 img").parentNode.clientHeight:("top"===o||"bottom"===o)&&(f=document.querySelector("#cell_0 img").parentNode.clientHeight/this.splitPercentage*(1-this.splitPercentage)),null!=this.ctaHeight&&(f=f-this.ctaHeight+2),u=this.getTallestTextArea(f);else{for(n=0;n<this.elements.length;)null!=document.getElementById("element_"+n+"_text_area")&&(f=this.recordTallestOverlay(this.cellDim[1],f,document.getElementById("element_"+n+"_overlay").clientHeight)),n++;null!=this.ctaHeight&&(f=f-this.ctaHeight+2),u=this.getTallestTextArea(f)}for(g=0,y=[];g<this.elements.length;)a=document.getElementById("cta-"+g),h=document.getElementById("element_"+g+"_text_area"),"image-with-text-overlay"===this.option.get("gridStyle")&&null!=h&&(s=h.parentNode.parentNode,r=document.getElementById("cell_"+g),s.style.height=r.clientHeight+"px"),null!==h&&(null!=a?(c=h.childNodes[0],m=c.clientHeight,e?(l=h.childNodes[0],x=Math.ceil((f-l.clientHeight)/3*2+l.clientHeight)):x=u,h.style.height=x+"px",c.style.paddingTop=(x-m)/6+"px",null!=a&&(a.style.marginBottom=Math.ceil(f-parseFloat(h.style.height))+1+"px")):h.style.height=f+2+"px"),y.push(g++);return y}},getBestFontSize:function(){var t,e,i,o,n,r,s,l,a;for(s=this.option.getFloat("autoScalePercentage"),t=1e4,l=this.elements,n=0,r=l.length;r>n;n++)e=l[n],a=this.getEachBestFontSize(this.cellDim[0],this.cellDim[1]*s,e.content),i=a[0],o=a[1],t=Math.min(t,i);return[t,o]},getEachBestFontSize:function(t,e,i){var o,n,r,s,l,a,h,c,p,d,g,u,m,y;if(t-=2*this.option.getInteger("padding")+4,l=document.createElement("div"),l.innerHTML=i,l.style.display="inline-block",l.style.width=t+"px",h=!1,a=0,r=this.option.get("showCTA")?this.ctaHeight:0,n=this.option.get("ctaTextSize"),s=this.option.get("ctaWidth"),o=l.querySelectorAll("span"),document.body.appendChild(l),l.clientHeight+r<e){for(y=this.helper.getMaxSpanFontSizeFromWrapper(l),d=this.option.getInteger("maxFontSize");d>=y;){for(c=0,p=o.length;p>c;c++)m=o[c],u=parseInt(m.style.fontSize),m.style.fontSize=u+1+"px";if(r+=1,g=(n+a+1)/n*s,l.clientHeight+r>e||g>=t-8-4)break;a+=1}h=!0}else h=!1;return document.body.removeChild(l),[a,h]},setFontSize:function(t){var e,i,o,n,r,s,l,a,h,c,p,d,g,u,m,y,f,x,C,v,S,b,w,k,I,E,T,P,_,H,F;for(x=this.option.get("maxFontSize"),C=C||!1,c=this.elementBeginIndex;c<this.elements.length;){if(l=document.getElementById("element_"+c+"_overlay"),s=document.getElementById("element_"+c+"_text_area"),null==s)return;for(n=l.querySelectorAll("div.rf-cta")[0],P=s.querySelectorAll("span"),p=0,u=P.length;u>p;p++)F=P[p],a=parseInt(NaN!==F.style.fontSize?F.style.fontSize:this.helper.getFontSizeStyle(F)),a+t>x&&(t=x-a),F.style.fontSize=t+a+"px";for(d=s.querySelectorAll("span#label")[0],E=s.querySelectorAll("span#price")[0],null!=d&&(g=parseInt(d.style.fontSize)+t+"px"),null!=n&&(w=parseInt(this.helper.getFontSizeStyle(n)),r=this.option.get("ctaWidth"),v=w+t,S=r*v/w,n.style.fontSize=v+"px",n.style.width=S+"px",this.ctaheight=this.ctaheight+t),k=parseInt(this.helper.getStyle(l,"width")),o=0,_=s.querySelectorAll("span"),b=0,m=_.length;m>b;b++)F=_[b],o=Math.max(parseInt(this.helper.getStyle(F,"width")),o);if(null!=g&&(o-k)/(parseInt(g)/3)>3)for(s.style.wordWrap="break-word",s.style.wordBreak="break-all",H=s.querySelectorAll("span"),I=0,y=H.length;y>I;I++)h=H[I],h.style.width=k+"px";else o>k&&t>0&&(C=!0);if(null!=E&&this.helper.isMultipleLine(E))for(i=[],null!=E.children&&(i=E.children),T=0,f=i.length;f>T;T++)e=i[T],"inline-block"===e.style.display&&(e.style.marginRight="");c++}return C?(C=!1,this.setFontSize(-1)):void 0},scaleFontSize:function(){var t;return null==this.bestFontSizeIncreseOffset&&(t=this.getBestFontSize(),this.bestFontSizeIncreseOffset=t[0],this.fontSizeNeedChange=t[1]),this.fontSizeNeedChange=this.fontSizeNeedChange||!0,this.fontSizeNeedChange?this.setFontSize(this.bestFontSizeIncreseOffset):void 0},recordTallestOverlay:function(t,e,i){return i>e&&t>i?i:e}}),o=function(t){function e(t,i,o){e.__super__.constructor.call(this),this.addDisclaimerCTA(t,o),this.addDisclaimerMsg(t,i,o)}return C(e,t),e.prototype.addDisclaimerCTA=function(t,e){var i,o,n;return i=this.option.getInteger("width"),o=document.createElement("div"),o.id="disclaimerCTA",o.innerHTML=this.option.get("disclaimerCTAtext"),n=document.createElement("div"),n.id="disCTAcontainer",this.helper.addClass(n,""+this._disCTAContainerClassName()),this.setDisCTAContainerStyle("."+this._disCTAContainerClassName(),t),n.appendChild(o),e.appendChild(n),document.getElementById("disclaimerCTA").className="ctaHover",this.helper.addEvent("disCTAcontainer","click",function(t){return function(){return t.toggleDisclaimer(),event.stopPropagation(),event.preventDefault()}}(this))},e.prototype.setDisCTAContainerStyle=function(t,e){return this.style.content+=t+"{ right: "+e/2+"px; }"},e.prototype.addDisclaimerMsg=function(t,e,i){var o;o=document.createElement("div"),o.id=this._disClaimerMsgClassName(),this.helper.addClass(o,"rf-hide"),this.setDisclaimerMsgStyle("#"+this._disClaimerMsgClassName()),o.innerHTML=this.option.get("disclaimer"),i.appendChild(o),this.helper.addEvent(o,"click",function(t){return function(){return t.toggleDisclaimer()}}(this))},e.prototype.setDisclaimerMsgStyle=function(t,e,i){return this.style.content+=t+"{ width: "+parseInt(e-30)+"px; height: "+parseInt(i-45)+"px; }"},e.prototype.toggleDisclaimer=function(){var t;return t=document.getElementById("disclaimerMsg"),this.helper.hasClass(t,"rf-hide")?(this.helper.removeClass(t,"rf-hide"),this.helper.addClass(t,"rf-inline-show")):(this.helper.removeClass(t,"rf-inline-show"),this.helper.addClass(t,"rf-hide"))},e.prototype._disCTAContainerClassName=function(){return"disCTAcontainer"},e.prototype._disClaimerMsgClassName=function(){return"disclaimerMsg"},e}(t),p=function(t){function e(t,i,o){this.toggleOverlay=S(this.toggleOverlay,this),e.__super__.constructor.call(this),this.loadImageGetDims(t,i,o)}return C(e,t),e.prototype.loadImageGetDims=function(t,e,i){var o;return o=new Image,this.helper.addClass(o,""+this._overlayImageClassName()),o.src=t,this.addStaticToStage(o,e,i)},e.prototype.addStaticToStage=function(t,e,i){var o;return t.onload=function(t){return function(){var o,n,r;return r=document.querySelectorAll("."+t._overlayImageClassName())[0],n=r.width,o=r.height,(e<r.width||i<r.height)&&(r.width/r.height<e/i?(o=i,n=r.width*o/r.height):(n=e,o=r.height*n/r.width)),t.setOverlayImageStyle("img."+t._overlayImageClassName(),n,o,e,i)}}(this),
o=document.createElement("div"),o.id="staticContainer",this.option.get("overlayAtBeginning")?(this.helper.addClass(o,"rf-block-show"),window.setTimeout(function(t){return function(){var e;return e=document.getElementById("stage"),t.helper.removeClass(e,"rf-hide"),t.hideOverlay()}}(this),this.option.getInteger("overlayToggleDelay"))):this.helper.addClass(o,"rf-hide"),this.setOverlayStaticContainer(o,e,i),o.appendChild(t),this.helper.hijackLinkElement(o,this.option.get("rfClkPrefix")+this.option.get("overlayStaticClickOut")),outerStage.appendChild(o),this.option.get("overlayAtBeginning")?void 0:this.startOverlay()},e.prototype.startOverlay=function(){return window.rocketfuel.overlayInterval=setInterval(function(t){return function(){return t.toggleOverlay()}}(this),this.option.getInteger("overlayToggleDelay"))},e.prototype.stopOverlay=function(){return window.clearInterval(window.rocketfuel.overlayInterval)},e.prototype.toggleOverlay=function(){var t,e;return e=document.getElementById("staticContainer"),this.helper.hasClass(e,"rf-hide")?(this.displayOverlay(),window.clearInterval(window.rocketfuel.curAnimationInterval)):(this.hideOverlay(),t=this.option.getInteger("animationFrameMillis"),window.rocketfuel.curAnimationInterval=window.setInterval(window.rocketfuel.curAnimationFunction,t))},e.prototype.displayOverlay=function(){var t;return t=document.getElementById("staticContainer"),this.helper.removeClass(t,"rf-hide"),this.helper.addClass(t,"rf-block-show")},e.prototype.hideOverlay=function(){var t;return t=document.getElementById("staticContainer"),this.helper.removeClass(t,"rf-block-show"),this.helper.addClass(t,"rf-hide")},e.prototype._overlayImageClassName=function(){return"rf-overlay-img"},e.prototype.setOverlayImageStyle=function(t,e,i,o,n){var r;return r=document.querySelectorAll("."+this._overlayImageClassName())[0],r.style.width=e+"px",r.style.height=i+"px",r.style.left=(o-e)/2+"px",r.style.top=(n-i)/2+"px",r.style.position="absolute"},e.prototype.setOverlayStaticContainer=function(t,e,i){var o;return t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.bottom="0px",t.style.right="0px",t.style.width=e+"px",t.style.height=i+"px","IE8"!==this.helper.checkNavigatorVersion()&&"IE9"!==this.helper.checkNavigatorVersion()||null==this.option.get("overlayColor").match(/^rgba/)?t.style.backgroundColor=""+this.option.get("overlayColor"):(o=this.helper.convertRGBA2Hex(this.option.get("overlayColor")),t.style.background="none",t.style.msFilter="progid:DXImageTransform.Microsoft.gradient(startColorstr="+o+",endColorstr="+o+")",t.style.filter="progid:DXImageTransform.Microsoft.gradient(startColorstr="+o+",endColorstr="+o+")",t.style.zoom="1"),t.style.zIndex="200",t.style.cursor="pointer",t.style.overflow="hidden"},e}(t),m=function(){function t(){this.content=""}return t.prototype.applyToPage=function(){var t,e;return e=document.createElement("style"),e.type="text/css",e.styleSheet?e.styleSheet.cssText=this.content:e.appendChild(document.createTextNode(this.content)),t=document.getElementsByTagName("body")[0],t.appendChild(e),this.content=""},t.prototype.prepareStaticStyle=function(t){return this.option=t,this.globalStyle(),this.cellLabelSpanStyle(),this.cellPriceSpanStyle(),this.disclaimerCTAStyle(),this.disCTAcontainerStyle(),this.disclaimerMsgStyle(),this.toggleDisplayStyle(),this.listPriceStyle()},t.prototype.globalStyle=function(){return this.content+="img{ border: none; }",this.content+=".hidden{ visibility: hidden; }"},t.prototype.toggleDisplayStyle=function(){return this.content+=".rf-inline-show{ visibility: visible; display: inline; }.rf-hide{ visibility: hidden; }.rf-block-show{ visibility: visible; display: block; }"},t.prototype.disclaimerMsgStyle=function(){return this.content+="#disclaimerMsg{ position: absolute; cursor: pointer; bottom: 30px; left: auto; top: auto; right: 10px; overflowY: auto; z-index: 105; text-decoration: none; color: #000; font-family: Arial; font-size: 11px; padding: 5px; background-color: rgba(255,255,255,0.96); border-radius: 5px; border: 1px solid #ccc; box-shadow: rgba(0, 0, 0, 0.2) 0px 0px 10px 0px; }"},t.prototype.disCTAcontainerStyle=function(){return this.content+="#disCTAcontainer{ position: absolute; bottom: -1px; zIndex: 100; cursor: pointer; }.ctaHover:hover{ text-decoration: underline; }"},t.prototype.disclaimerCTAStyle=function(){return this.content+="#disclaimerCTA{ display: block; z-index: 100; top: auto; position: relative; left: 50%; padding: 5px; background-color: #FFFFFF; border-top: 1px solid #ccc; border-left: px solid #ccc; border-right: 1px solid #ccc; border-radius: 5px 5px 0px 0px; text-decoration:; font-family: Arial; text-align: center; color: "+this.option.get("disclaimerCTAcolor")+"; font-size: "+this.option.get("disclaimerCTAsize")+"px; box-shadow: rgba(0, 0, 0, 0.2) 0px 0px 10px 0px; }"},t.prototype.cellLabelSpanStyle=function(){return this.content+="span.rf-cell-label{ display: block; font-weight: bold; font-size: 12px; font-family: Helvetica,sans-serif; color: #000; }"},t.prototype.cellPriceSpanStyle=function(){return this.content+="span.rf-cell-price{ display: block; font-weight: normal; font-size: 12px; font-family: Helvetica,sans-serif; color: #000; }"},t.prototype.listPriceStyle=function(){return this.content+="#listPrice{ color: "+this.option.get("listPriceFontColor")+";",this.option.get("listPriceFontColor")>0&&(this.content+="font-size: "+this.option.get("listPriceFontSize")+"px"),this.content+="}"},t}(),u=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return C(e,t),e.prototype.getOrCreateStage=function(t,e){var i,o;return o=document.getElementById("stage"),null===o&&(o=document.createElement("div"),o.id="stage",this.option.get("overlayAtBeginning")&&this.option.get("overlayStatic")&&null!=this.option.get("overlayStaticURL")&&this.option.get("overlayStaticURL").length>0&&this.helper.addClass(o,"rf-hide"),i=document.createElement("a"),i.href=e,this.helper.hijackLinkElement(i,e),i.target="_blank",i.appendChild(o),t.appendChild(i)),o},e.prototype.updateStage=function(t,e,i){var o,n;return o=this.option.get("bgColor"),n=this.option.get("logoColor"),n||(n=o),this.setStageStyle("#"+t.id,e,i,n)},e.prototype.setStageStyle=function(t,e,i,o){return this.style.content+=t+"{ cursor: pointer; border: "+this.option.get("border")+"; width: "+e+"px; height: "+i+"px; overflow: hidden; background-color: "+o+"; position: relative; "+(this.option.get("enableBgGradient")?this.bgGradientStyle():void 0)+" }"},e.prototype.bgGradientStyle=function(){var t,e,i,o;return t=this.option.get("bgGradientDirection")+"deg",o=this.option.get("bgGradientStartColor"),e=this.option.get("bgGradientEndColor"),i=t+", "+o+", "+e,"background: -webkit-linear-gradient("+i+"); background: -o-linear-gradient("+i+"); background: -moz-linear-gradient("+i+"); background: linear-gradient("+i+");"},e}(t),a=function(){function t(){this.logs=[]}return t.prototype.log=function(t){return this.logs=this.logs||[],this.logs.push(t)},t.prototype.allLogs=function(){var t,e,i,o,n;for(o=this.logs,n=[],t=0,e=o.length;e>t;t++)i=o[t],"undefined"!=typeof console&&null!==console?n.push(console.log(i+"\n")):n.push(void 0);return n},t}(),h=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return C(e,t),e.prototype.createLogoElement=function(t,e,i,o,n,r,s,l,a,h,c,p,d,g,u){var m,y,f,x,C,v,S,b,w,k,I,E;return C=this.option.get("gridTop"),f=this.option.get("gridLeft"),x=this.option.get("gridRight"),m=this.option.get("gridBottom"),v=l-2,y=a-2,"top"===t?(w=this._createLogoElement(e,i+encodeURIComponent(o),n,r,s,t,2,l,a),c=w[2],p.appendChild(w[0]),d.showPromo&&(I=d.createPromo(o,w,i,a,l),k=I[0],a=I[1],l=I[2],p.appendChild(k),g=d.promoHeight,"top"===d.promoLoc?c+=g:"bottom"===d.promoLoc&&(y-=d.promoHeight)),y-=c):"left"===t&&(S=document.createElement("span"),S.id="helperLeftSpan",b=document.createElement("span"),b.id="helperRightSpan",this.helper.addClass(S,""+this._helperLeftSpanClassName()),this.setHelperTopSpanStyle("span."+this._helperLeftSpanClassName()),p.appendChild(S),w=this._createLogoElement(e,i+encodeURIComponent(o),n,r,s,t,2,l,a),h=w[1],p.appendChild(w[0]),p.appendChild(b),d.showPromo&&(E=d.createPromo(o,w,i,a,l),k=E[0],a=E[1],l=E[2],p.appendChild(k),"left"===d.promoLoc?h+=d.promoWidth:"right"===d.promoLoc&&(v-=d.promoWidth)),v-=h),(C>0||m>0)&&(y=a-2-(C+m),c=C),(f>0||x>0)&&(v=l-2-(f+x),h=f),[v,y,h,c,p]},e.prototype._createLogoElement=function(t,e,i,o,n,r,s,l,a){var h,c,p,d,g,u,m,y,f,x,C,v,S;return f=this.option.get("maxLogoHeight"),u=this.option.get("logoAlignment"),x=this.option.get("maxLogoWidth"),v=n,C=o,S=0,g=0,"top"===r?(c=parseFloat(l-2*s-2*i),n=c>n?n:c,o=o*n/v):(h=parseFloat(a-2*s-2*i),o=h>o?o:h,n=o*n/C),n>x&&(n=x,o=n*C/v),o>f&&(o=f,n=o*v/C),"top"===r?(S=s+i,g="left"===u?i:"right"===u?l-n-i:(l-n)/2):(g=s+i,S="top"===u?i:"bottom"===u?a-o-i:(a-o)/2),y=document.createElement("img"),this.helper.addClass(y,""+this._logoElementClassName()),this.setLogoElementStyle("img."+this._logoElementClassName(),n,o,S,g),m=document.createElement("a"),m.href=e,m.id="logo-click",m.target="_blank",m.appendChild(y),y.src=t,p=g+n+i,d=s+2*i+o,[m,p,d]},e.prototype._logoElementClassName=function(){return"rf-logo-element"},e.prototype._helperLeftSpanClassName=function(){return"rf-helper-left-span"},e.prototype.setLogoElementStyle=function(t,e,i,o,n){return this.style.content+=t+"{ width: "+e+"px; height: "+i+"px; top: "+o+"px; left: "+n+"px; border: 0px; position: absolute; z-index: 5; -webkit-filter: blur(0); }"},e.prototype.setHelperTopSpanStyle=function(t){return this.style.content+=t+"{ display: inline-block; height: 100%; vertical-align: middle; }"},e}(t),n=function(t){function e(){return this.createGridFn=S(this.createGridFn,this),e.__super__.constructor.apply(this,arguments)}return C(e,t),e.prototype.createGridFn=function(){var t;return this.option.isDefined()?(this.style.prepareStaticStyle(this.option),this.attemptToCreateGrid(),this.style.applyToPage(),t=window.setInterval(function(e){return function(){return null!=e.grid&&e.grid.fitGridWidthAndHeight(),window.clearInterval(t)}}(this),100)):(this.option.init(),window.setTimeout(this.createGridFn,10))},e.prototype.attemptToCreateGrid=function(t,e){var i,n,r,l,a,c,g,m,y,f,x,C,v,S,b,w,k,I,E,T,P,_,H,F,A,D,B,L,M,z,W,N,O,R,G;if(b=this.option.get("logoClk"),W=this.option.get("rfClkPrefix"),this.stageClass=new u,F=document.getElementById("outerStage"),null!=F&&(F.style.visibility="hidden"),O=document.getElementById("stage"),null!==F&&null===O&&(O=this.stageClass.getOrCreateStage(F,W+b)),null===O)return void window.setTimeout(function(i){return function(){return i.attemptToCreateGrid(t,e),i.style.applyToPage()}}(this),10);for(;O.hasChildNodes();)O.removeChild(O.lastChild);return n=null!=t&&options.dynamicResize?t:this.option.getInteger("width"),i=null!=e&&options.dynamicResize?e:this.option.getInteger("height")||window.innerHeight,G=n-2,R=i-2,this.stageClass.updateStage(O,G,R),B=this.option.getInteger("padding"),T=this.option.get("logoPosition"),S="inProds"===T,k=this.option.get("logoHeight"),P=this.option.get("logoWidth"),I=this.option.get("logoImg"),y=this.option.get("clkPrefix"),f=this.option.get("clkSuffix"),E=this.option.getInteger("logoPadding"),a=this.option.get("borderColor"),c=this.option.get("borderHoverColor"),g=this.option.get("cellTransform"),m=this.option.get("cellTransition"),r=this.option.get("backgroundImageSize"),A=this.option.get("overlayStatic"),D=this.option.get("overlayStaticURL"),x=this.option.getInteger("ctaWidth"),N=this.option.get("showContent"),H=0,_=0,M=0,this.setOuterStageStyle("#outerStage",G,R),this.grid=new s,L=new d(this.grid,n,i,B),w=new h,z=w.createLogoElement(T,I,W,b,E,k,P,n,i,_,H,O,L,M),v=z[0],C=z[1],_=z[2],H=z[3],O=z[4],this.grid.generateGrid(n,i,_,H,B,v,C,I,S,W,b,y,f,this.option.get("showCTA"),x,a,c,O,g,m,r,N),l=this.option.get("bgPattern"),null!=l&&""!==l&&(this.option.attrIsConfigured("bgColor")||this.option.attrIsConfigured("logoColor ")?document.getElementById("grid").style.backgroundImage="url("+l+")":document.getElementById("stage").style.backgroundImage="url("+l+")"),this.option.get("showDisclaimer")&&(this.disclaimer=new o(v,C,F)),this.option.get("overlayStatic")?this.overlay=new p(D,n,i):void 0},e.prototype.run=function(){return this.createGridFn()},e.prototype.setOuterStageStyle=function(t,e,i){return this.style.content+=t+"{ width: "+e+"px; height: "+i+"px; position: absolute; }"},e}(t),window.rocketfuel={option:new c,helper:new l,style:new m,logger:new a},y=new n,y.run()}).call(this);